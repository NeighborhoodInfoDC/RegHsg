"RECREATIONAL - VACANT",
"RETAIL STORE - VACANT",
"SHOPPING CENTER - VACANT",
"SINGLE FAMILY - VACANT",
"TOWNHOUSES - VACANT",
"TRAILER PARK - VACANT",
"VACANT LAND",
"WAREHOUSE - VACANT",
"WINERY - VACANT")
jur <- jur %>%
mutate(category = case_when(
countylandusedescription %in% other ~ "other",
countylandusedescription %in% mf ~ "mf",
countylandusedescription %in% sf ~ "sf",
countylandusedescription %in% vacant ~ "vacant",
is.na(countylandusedescription) ~ "missing"))
rm(other, mf, sf, vacant)
apartment <- c("MULTI-FAMILY",
"MULTIPLE OCCUPANCIES")
commercial <- c("AUTO SALES",
"AUTOMOTIVE BUILDINGS",
"BANK",
"CEMETERY",
"CHURCH",
"COMMERCIAL",
"COMMERCIAL CONDO'S",
"COMMERCIAL CONDOS",
"CONDO-FLEX WAREHOUSE",
"CONDO-WAREHOUSE",
"DATA CENTER",
"FARM > 20 ACRES",
"FAST FOOD RESTAURANT",
"FLEX WAREHOUSE",
"GAS AND GO",
"GROCERY STORE",
"HOTEL LUXURY",
"LIGHT INDUSTRIAL",
"MEDICAL BUILDING",
"MEDIUM/HEAVY INDUST",
"MINI WAREHOUSE",
"MISC COMM STRUCTURE",
"MISC COMMERCIAL STRUCTURE",
"MOTEL/HOTEL",
"RESTAURANT",
"RETAIL STORE",
"SHOPPING CENTER",
"WAREHOUSE",
"WINERY")
condo <- c("RESIDENTIAL CONDOS",
"CONDOMINIUM (RESIDENTIAL)",
"RES CONDO GARAGE UNIT")
duplex <- c("DUPLEX")
office <- c("OFFICE BUILDING",
"OFFICE/RETAIL")
mfattached <- c("MULTI-FAMILY",
"MULTIPLE OCCUPANCIES")
sfdetached <- c("SINGLE FAMILY",
"RURAL RESIDENCE (AGRICULTURAL)",
"RURAL RESIDENCE AGRICULTURAL")
trailer <- c("MOBILE/MANUFACTURED HOMES",
"TRAILER PARK")
townhouse <- c("TOWN HOUSES")
educational <- c("EDUCATIONAL")
firedepartment <- c("FIRE DEPT")
recreational <- c("RECREATIONAL")
govt <- c("GOVERNMENT PROPERTY",
"GOVT PROP")
otheruse <- c("HANGER",
"IMPROVED, USE NOT SPECIFIED",
"LEASEHOLD RIGHTS (MISC)",
"MISC IMPROVEMENTS",
"MISCELLANEOUS (GENERAL)")
vacantcom <- c("AUTOMOTIVE BUILDINGS - VACANT",
"COMMERCIAL CONDOS - VACANT",
"FLEX WAREHOUSE - VACANT",
"GROCERY STORE - VACANT",
"MINI WAREHOUSE - VACANT",
"MISC COMM STRUCTURE - VACANT",
"MISC COMMERCIAL STRUCTURE - VACANT",
"RETAIL STORE - VACANT",
"SHOPPING CENTER - VACANT",
"WAREHOUSE - VACANT",
"WINERY - VACANT")
vacantother <- c("VACANT LAND",
"MISC IMPROVEMENTS - VACANT",
"RECREATIONAL - VACANT")
vacantmf <- c("MULTI-FAMILY - VACANT")
vacantoffice <- c("OFFICE BUILDING - VACANT")
vacantsf <- c("SINGLE FAMILY - VACANT")
vacanttownhouse <- c("TOWNHOUSES - VACANT")
vacanttrailer <- c("TRAILER PARK - VACANT")
jur <- jur %>%
mutate(category_detail = case_when(
countylandusedescription %in% apartment ~ "apartment",
countylandusedescription %in% commercial ~ "commercial",
countylandusedescription %in% condo ~ "condo",
countylandusedescription %in% duplex ~ "duplex",
countylandusedescription %in% office ~ "office",
countylandusedescription %in% mfattached ~ "mf attached",
countylandusedescription %in% sfdetached ~ "sf detached",
countylandusedescription %in% trailer ~ "trailer",
countylandusedescription %in% townhouse ~ "townhouse",
countylandusedescription %in% educational ~ "educational",
countylandusedescription %in% firedepartment ~ "fire department",
countylandusedescription %in% recreational ~ "recreational",
countylandusedescription %in% govt ~ "government",
countylandusedescription %in% otheruse ~ "other use",
countylandusedescription %in% vacantcom ~ "vacant commercial",
countylandusedescription %in% vacantother ~ "vacant other",
countylandusedescription %in% vacantmf ~ "vacant mf",
countylandusedescription %in% vacantoffice ~ "vacant office",
countylandusedescription %in% vacantsf ~ "vacant sf",
countylandusedescription %in% vacanttownhouse ~ "vacant townhouse",
countylandusedescription %in% vacanttrailer ~ "vacant trailer",
is.na(countylandusedescription) ~ "missing"))
rm(apartment, commercial, condo, duplex,
office, mfattached, sfdetached, trailer, townhouse,
educational, firedepartment, recreational, govt, otheruse, vacantcom, vacantother, vacantmf,
vacantoffice, vacantsf, vacanttownhouse, vacanttrailer)
jur <- jur %>%
mutate(building_type = "")
count(jur, residential)
count(jur, is.na(residential))
if (TRUE %in% is.na(jur$residential)) {
warning("NAs introduced")
}
count(jur, residential)
count(jur, is.na(residential))
count(jur, residential)
count(jur, is.na(residential))
if (TRUE %in% is.na(jur$residential)) {
warning("NAs introduced")
}
count(jur, category_detail)
count(jur, is.na(category_detail))
count(jur, category_detail)
count(jur, is.na(category_detail))
if (TRUE %in% is.na(jur$category_detail)) {
warning("NAs introduced")
}
count(jur, category_detail)
count(jur, is.na(category_detail))
if (TRUE %in% is.na(jur$category_detail)) {
warning("NAs introduced")
}
if (TRUE %in% is.na(jur$category)) {
warning("NAs introduced")
}
count(jur, category)
other <- c("AUTO SALES",
"AUTOMOTIVE BUILDINGS",
"BANK",
"CEMETERY",
"CHURCH",
"COMMERCIAL",
"COMMERCIAL CONDO'S",
"COMMERCIAL CONDOS",
"CONDO-FLEX WAREHOUSE",
"CONDO-WAREHOUSE",
"DATA CENTER",
"EDUCATIONAL",
"FARM > 20 ACRES",
"FAST FOOD RESTAURANT",
"FIRE DEPT",
"FLEX WAREHOUSE",
"GAS AND GO",
"GOVERNMENT PROPERTY",
"GOVT PROP",
"GROCERY STORE",
"HANGER",
"HOTEL LUXURY",
"IMPROVED, USE NOT SPECIFIED",
"LEASEHOLD RIGHTS (MISC)",
"LIGHT INDUSTRIAL",
"MEDICAL BUILDING",
"MEDIUM/HEAVY INDUST",
"MINI WAREHOUSE",
"MISC COMM STRUCTURE",
"MISC COMMERCIAL STRUCTURE",
"MISC IMPROVEMENTS",
"MISCELLANEOUS (GENERAL)",
"MOTEL/HOTEL",
"OFFICE BUILDING",
"OFFICE/RETAIL",
"RECREATIONAL",
"RESTAURANT",
"RETAIL STORE",
"SHOPPING CENTER",
"WAREHOUSE",
"WINERY")
mf <- c("DUPLEX",
"MULTI-FAMILY",
"MULTIPLE OCCUPANCIES",
"RESIDENTIAL CONDOS",
"CONDOMINIUM (RESIDENTIAL)",
"RES CONDO GARAGE UNIT")
sf <- c("RURAL RESIDENCE (AGRICULTURAL)",
"RURAL RESIDENCE AGRICULTURAL",
"SINGLE FAMILY",
"MOBILE/MANUFACTURED HOMES",
"TOWN HOUSES",
"TRAILER PARK")
vacant <- c("AUTOMOTIVE BUILDINGS - VACANT",
"COMMERCIAL CONDOS - VACANT",
"FLEX WAREHOUSE - VACANT",
"GROCERY STORE - VACANT",
"MINI WAREHOUSE - VACANT",
"MISC COMM STRUCTURE - VACANT",
"MISC COMMERCIAL STRUCTURE - VACANT",
"MISC IMPROVEMENTS - VACANT",
"MULTI-FAMILY - VACANT",
"OFFICE BUILDING - VACANT",
"RECREATIONAL - VACANT",
"RETAIL STORE - VACANT",
"SHOPPING CENTER - VACANT",
"SINGLE FAMILY - VACANT",
"TOWNHOUSES - VACANT",
"TRAILER PARK - VACANT",
"VACANT LAND",
"WAREHOUSE - VACANT",
"WINERY - VACANT")
jur <- jur %>%
mutate(category = case_when(
countylandusedescription %in% other ~ "other",
countylandusedescription %in% mf ~ "mf",
countylandusedescription %in% sf ~ "sf",
countylandusedescription %in% vacant ~ "vacant",
is.na(countylandusedescription) ~ "missing"))
rm(other, mf, sf, vacant)
apartment <- c("MULTI-FAMILY",
"MULTIPLE OCCUPANCIES")
commercial <- c("AUTO SALES",
"AUTOMOTIVE BUILDINGS",
"BANK",
"CEMETERY",
"CHURCH",
"COMMERCIAL",
"COMMERCIAL CONDO'S",
"COMMERCIAL CONDOS",
"CONDO-FLEX WAREHOUSE",
"CONDO-WAREHOUSE",
"DATA CENTER",
"FARM > 20 ACRES",
"FAST FOOD RESTAURANT",
"FLEX WAREHOUSE",
"GAS AND GO",
"GROCERY STORE",
"HOTEL LUXURY",
"LIGHT INDUSTRIAL",
"MEDICAL BUILDING",
"MEDIUM/HEAVY INDUST",
"MINI WAREHOUSE",
"MISC COMM STRUCTURE",
"MISC COMMERCIAL STRUCTURE",
"MOTEL/HOTEL",
"RESTAURANT",
"RETAIL STORE",
"SHOPPING CENTER",
"WAREHOUSE",
"WINERY")
condo <- c("RESIDENTIAL CONDOS",
"CONDOMINIUM (RESIDENTIAL)",
"RES CONDO GARAGE UNIT")
duplex <- c("DUPLEX")
office <- c("OFFICE BUILDING",
"OFFICE/RETAIL")
mfattached <- c("MULTI-FAMILY",
"MULTIPLE OCCUPANCIES")
sfdetached <- c("SINGLE FAMILY",
"RURAL RESIDENCE (AGRICULTURAL)",
"RURAL RESIDENCE AGRICULTURAL")
trailer <- c("MOBILE/MANUFACTURED HOMES",
"TRAILER PARK")
townhouse <- c("TOWN HOUSES")
educational <- c("EDUCATIONAL")
firedepartment <- c("FIRE DEPT")
recreational <- c("RECREATIONAL")
govt <- c("GOVERNMENT PROPERTY",
"GOVT PROP")
otheruse <- c("HANGER",
"IMPROVED, USE NOT SPECIFIED",
"LEASEHOLD RIGHTS (MISC)",
"MISC IMPROVEMENTS",
"MISCELLANEOUS (GENERAL)")
vacantcom <- c("AUTOMOTIVE BUILDINGS - VACANT",
"COMMERCIAL CONDOS - VACANT",
"FLEX WAREHOUSE - VACANT",
"GROCERY STORE - VACANT",
"MINI WAREHOUSE - VACANT",
"MISC COMM STRUCTURE - VACANT",
"MISC COMMERCIAL STRUCTURE - VACANT",
"RETAIL STORE - VACANT",
"SHOPPING CENTER - VACANT",
"WAREHOUSE - VACANT",
"WINERY - VACANT")
vacantother <- c("VACANT LAND",
"MISC IMPROVEMENTS - VACANT",
"RECREATIONAL - VACANT")
vacantmf <- c("MULTI-FAMILY - VACANT")
vacantoffice <- c("OFFICE BUILDING - VACANT")
vacantsf <- c("SINGLE FAMILY - VACANT")
vacanttownhouse <- c("TOWNHOUSES - VACANT")
vacanttrailer <- c("TRAILER PARK - VACANT")
jur <- jur %>%
mutate(category_detail = case_when(
countylandusedescription %in% apartment ~ "apartment",
countylandusedescription %in% commercial ~ "commercial",
countylandusedescription %in% condo ~ "condo",
countylandusedescription %in% duplex ~ "duplex",
countylandusedescription %in% office ~ "office",
countylandusedescription %in% mfattached ~ "mf attached",
countylandusedescription %in% sfdetached ~ "sf detached",
countylandusedescription %in% trailer ~ "trailer",
countylandusedescription %in% townhouse ~ "townhouse",
countylandusedescription %in% educational ~ "educational",
countylandusedescription %in% firedepartment ~ "fire department",
countylandusedescription %in% recreational ~ "recreational",
countylandusedescription %in% govt ~ "government",
countylandusedescription %in% otheruse ~ "other use",
countylandusedescription %in% vacantcom ~ "vacant commercial",
countylandusedescription %in% vacantother ~ "vacant other",
countylandusedescription %in% vacantmf ~ "vacant mf",
countylandusedescription %in% vacantoffice ~ "vacant office",
countylandusedescription %in% vacantsf ~ "vacant sf",
countylandusedescription %in% vacanttownhouse ~ "vacant townhouse",
countylandusedescription %in% vacanttrailer ~ "vacant trailer",
is.na(countylandusedescription) ~ "missing"))
rm(apartment, commercial, condo, duplex,
office, mfattached, sfdetached, trailer, townhouse,
educational, firedepartment, recreational, govt, otheruse, vacantcom, vacantother, vacantmf,
vacantoffice, vacantsf, vacanttownhouse, vacanttrailer)
jur <- jur %>%
mutate(building_type = "")
count(jur, residential)
count(jur, is.na(residential))
count(jur, residential)
count(jur, is.na(residential))
if (TRUE %in% is.na(jur$residential)) {
warning("NAs introduced")
}
count(jur, category)
count(jur, is.na(category))
if (TRUE %in% is.na(jur$category)) {
warning("NAs introduced")
}
count(jur, category_detail)
apartment <- c("MULTI-FAMILY",
"MULTIPLE OCCUPANCIES")
commercial <- c("AUTO SALES",
"AUTOMOTIVE BUILDINGS",
"BANK",
"CEMETERY",
"CHURCH",
"COMMERCIAL",
"COMMERCIAL CONDO'S",
"COMMERCIAL CONDOS",
"CONDO-FLEX WAREHOUSE",
"CONDO-WAREHOUSE",
"DATA CENTER",
"FARM > 20 ACRES",
"FAST FOOD RESTAURANT",
"FLEX WAREHOUSE",
"GAS AND GO",
"GROCERY STORE",
"HOTEL LUXURY",
"LIGHT INDUSTRIAL",
"MEDICAL BUILDING",
"MEDIUM/HEAVY INDUST",
"MINI WAREHOUSE",
"MISC COMM STRUCTURE",
"MISC COMMERCIAL STRUCTURE",
"MOTEL/HOTEL",
"RESTAURANT",
"RETAIL STORE",
"SHOPPING CENTER",
"WAREHOUSE",
"WINERY")
condo <- c("RESIDENTIAL CONDOS",
"CONDOMINIUM (RESIDENTIAL)",
"RES CONDO GARAGE UNIT")
duplex <- c("DUPLEX")
office <- c("OFFICE BUILDING",
"OFFICE/RETAIL")
mfattached <- c("MULTI-FAMILY",
"MULTIPLE OCCUPANCIES")
sfdetached <- c("SINGLE FAMILY",
"RURAL RESIDENCE (AGRICULTURAL)",
"RURAL RESIDENCE AGRICULTURAL")
trailer <- c("MOBILE/MANUFACTURED HOMES",
"TRAILER PARK")
townhouse <- c("TOWN HOUSES")
educational <- c("EDUCATIONAL")
firedepartment <- c("FIRE DEPT")
recreational <- c("RECREATIONAL")
govt <- c("GOVERNMENT PROPERTY",
"GOVT PROP")
otheruse <- c("HANGER",
"IMPROVED, USE NOT SPECIFIED",
"LEASEHOLD RIGHTS (MISC)",
"MISC IMPROVEMENTS",
"MISCELLANEOUS (GENERAL)")
vacantcom <- c("AUTOMOTIVE BUILDINGS - VACANT",
"COMMERCIAL CONDOS - VACANT",
"FLEX WAREHOUSE - VACANT",
"GROCERY STORE - VACANT",
"MINI WAREHOUSE - VACANT",
"MISC COMM STRUCTURE - VACANT",
"MISC COMMERCIAL STRUCTURE - VACANT",
"RETAIL STORE - VACANT",
"SHOPPING CENTER - VACANT",
"WAREHOUSE - VACANT",
"WINERY - VACANT")
vacantother <- c("VACANT LAND",
"MISC IMPROVEMENTS - VACANT",
"RECREATIONAL - VACANT")
vacantmf <- c("MULTI-FAMILY - VACANT")
vacantoffice <- c("OFFICE BUILDING - VACANT")
vacantsf <- c("SINGLE FAMILY - VACANT")
vacanttownhouse <- c("TOWNHOUSES - VACANT")
vacanttrailer <- c("TRAILER PARK - VACANT")
jur <- jur %>%
mutate(category_detail = case_when(
countylandusedescription %in% apartment ~ "apartment",
countylandusedescription %in% commercial ~ "commercial",
countylandusedescription %in% condo ~ "condo",
countylandusedescription %in% duplex ~ "duplex",
countylandusedescription %in% office ~ "office",
countylandusedescription %in% mfattached ~ "mf attached",
countylandusedescription %in% sfdetached ~ "sf detached",
countylandusedescription %in% trailer ~ "trailer",
countylandusedescription %in% townhouse ~ "townhouse",
countylandusedescription %in% educational ~ "educational",
countylandusedescription %in% firedepartment ~ "fire department",
countylandusedescription %in% recreational ~ "recreational",
countylandusedescription %in% govt ~ "government",
countylandusedescription %in% otheruse ~ "other use",
countylandusedescription %in% vacantcom ~ "vacant commercial",
countylandusedescription %in% vacantother ~ "vacant other",
countylandusedescription %in% vacantmf ~ "vacant mf",
countylandusedescription %in% vacantoffice ~ "vacant office",
countylandusedescription %in% vacantsf ~ "vacant sf",
countylandusedescription %in% vacanttownhouse ~ "vacant townhouse",
countylandusedescription %in% vacanttrailer ~ "vacant trailer",
is.na(countylandusedescription) ~ "missing"))
rm(apartment, commercial, condo, duplex,
office, mfattached, sfdetached, trailer, townhouse,
educational, firedepartment, recreational, govt, otheruse, vacantcom, vacantother, vacantmf,
vacantoffice, vacantsf, vacanttownhouse, vacanttrailer)
jur <- jur %>%
mutate(building_type = "")
count(jur, residential)
count(jur, is.na(residential))
if (TRUE %in% is.na(jur$residential)) {
warning("NAs introduced")
}
count(jur, category)
count(jur, category_detail)
count(jur, is.na(category_detail))
if (TRUE %in% is.na(jur$category_detail)) {
warning("NAs introduced")
}
count(jur, category)
count(jur, is.na(category))
if (TRUE %in% is.na(jur$category)) {
warning("NAs introduced")
}
##### `category_detail`
```{r catd-check}
count(jur, category_detail)
count(jur, is.na(category_detail))
if (TRUE %in% is.na(jur$category_detail)) {
warning("NAs introduced")
}
```{r bt-check}
newcat <- sum(!is.na(jur$building_type))
mf <- nrow(filter(jur, category == "mf"))
if (mf != newcat) {
warning(newcat, " observations categorized, expecting ", mf)
}
rm(newcat, mf)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
# knitr::opts_chunk$set(eval = FALSE)
library(tidyverse)
library(DescTools)
library(purrr)
source("../Macros/sample-properties.R")
source("../Macros/classify-addresses.R")
source("Macros/sample-properties.R")
LU_HUNITS_EXIST = col_double(),
install.packages("tidyverse")
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
source("../Macros/read-bk.R")
source("../Macros/filter-bk.R")
source("../Macros/select-vars.R")
currentfips <- "51107"
filepath <- "loudoun"
jdir <- paste0("L:/Libraries/RegHsg/Data/", filepath, "/")
rdir <- paste0("L:/Libraries/RegHsg/Raw/", filepath, "/")
if (!dir.exists("../Data")) {
dir.create("../Data")
}
if (!dir.exists(paste0("L:/Libraries/RegHsg/Raw/", filepath))) {
dir.create(paste0("L:/Libraries/RegHsg/Raw/", filepath))
}
if (!exists("region")) {
region <- read_bk("dc-cog-assessment_20181228.csv")
} else {
warning("region data already read in")
}
